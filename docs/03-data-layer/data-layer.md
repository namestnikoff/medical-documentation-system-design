# Слой данных

Раздел описывает логическую модель данных, используемую в системе автоматизации медицинских документов.

## Основные сущности

- Пациент (Patient)
- Врач (Doctor)
- Приём (Appointment)
- МедДокумент (MedicalDocument)
- Подпись (Signature)
- Событие обмена (DataEvent)

## Диаграмма связей

![Диаграмма сущностей слоя данных](http://www.plantuml.com/plantuml/proxy?cache=no&src=https://raw.githubusercontent.com/namestnikoff/medical-documentation-system-design/main/docs/03-data-layer/diagrams/entities.puml)

[Исходный код диаграммы](diagrams/entities.puml)

## Обоснование выбора СУБД

В качестве основной СУБД используется PostgreSQL — обеспечивает транзакционность, поддерживает сложные связи и текстовый поиск, соответствует требованиям по хранению медицинских и персональных данных.

## Дополнительная информация

- Для интеграции предусмотрен слой GraphQL, агрегирующий данные из микросервисов.
- Все изменения документов и подписей проходят аудит и versioning.

## Поисковые возможности и масштабирование

- Для полнотекстового поиска по медицинским документам и справочникам используются GIN-индексы PostgreSQL.
- При повышенной нагрузке или необходимости федеративного/кластерного поиска возможен переход на внешний движок поиска — например, OpenSearch (совместим с экосистемой Elasticsearch, поддерживает масштабирование, балансировку, репликацию).
- Архитектура допускает гибридный вариант: микросервис поиска агрегирует индексы PostgreSQL для оперативных задач и OpenSearch — для сложных аналитических запросов.

_Выбор между встроенным поиском и выделенной поисковой системой определяется бизнес-требованиями к скорости, масштабируемости и объёму данных._
