# Безопасность

## Аутентификация и авторизация

**Внутренние пользователи (врачи, регистраторы, КМС, администраторы):**
- Аутентификация логин/пароль → JWT-токен (access на 15 мин, refresh на 7 дней)
- JWT содержит роль для проверки прав (RBAC)

**Пациенты:**
- Вход через ЕСИА (OAuth 2.0 / OpenID Connect) — государственная аутентификация
- Альтернатива: локальная регистрация логин/пароль

**Многофакторная аутентификация (MFA):** для критичных операций (подписание УКЭП, изменение прав, экспорт данных).

---

## Защита данных

- **Шифрование при хранении:** AES-256 для чувствительных полей (СНИЛС, диагнозы)
- **Шифрование при передаче:** TLS 1.3 для всех внешних соединений
- **Управление ключами:** Key Management Service / HSM, ротация каждые 12 месяцев
- **Локализация (242-ФЗ):** все ПДн российских граждан хранятся на территории РФ

---

## Аудит и логирование

- **Неизменяемый журнал:** все операции с ПДн и документами в append-only журнале
- **Содержание:** пользователь, действие, объект, дата/время, IP-адрес
- **Хранение:** минимум 3 года (требование 911н)
- **Защита:** логи защищены от удаления, доступ только у администраторов безопасности

---

## Соответствие законодательству РФ

**Приказ Минздрава 911н (требования к МИС):**
- Ведение ЭМК, протоколирование действий
- Резервное копирование (RPO ≤ 5 мин, хранение 3+ года)
- Контроль целостности (SHA-256, УКЭП)
- RBAC

**323-ФЗ (Охрана здоровья):**
- Электронная подпись (УКЭП) для СЭМД
- Защита врачебной тайны (доступ только участников лечения + пациент)

**152-ФЗ (Персональные данные):**
- Согласие пациента, права субъектов данных
- Обработка и хранение на территории РФ (242-ФЗ)

---

## Защита от уязвимостей

- **SQL-инъекции:** параметризованные запросы, валидация входных данных
- **XSS / CSRF:** Content Security Policy, CSRF-токены
- **Минимальные привилегии БД:** только SELECT/INSERT/UPDATE, без DROP/ALTER
- **Rate limiting:** защита от DoS
- **Регулярные пентесты:** периодические проверки безопасности специализированными инструментами
